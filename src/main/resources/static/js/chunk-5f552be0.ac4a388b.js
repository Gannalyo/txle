(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f552be0"],{"02eb":function(e,t,a){"use strict";var o=a("3f95"),n=a.n(o);n.a},"3f95":function(e,t,a){},"63fb":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{},[a("el-button-group",[a("el-button",{staticClass:"margin-right10",attrs:{type:"primary",size:"small"},on:{click:e.freshen}},[e._v("刷新当前页")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.add()}}},[e._v("新增")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-finished"},on:{click:function(t){e.modify()}}},[e._v("编辑")]),a("Poptip",{attrs:{confirm:"",title:"配置删除需谨慎，请确认!"},on:{"on-ok":e.remove}},[a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-minus"}},[e._v("删除")])],1)],1),a("el-input",{staticStyle:{width:"200px",float:"right"},attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){e.search()}},slot:"append"})],1)],1),a("div",{staticStyle:{display:"none"}},[a("Modal",{attrs:{draggable:"",title:"Txle","footer-hide":""},on:{"on-ok":function(t){e.save()},"on-cancel":e.cancel},model:{value:e.modalAdd,callback:function(t){e.modalAdd=t},expression:"modalAdd"}},[a("el-form",{ref:"ruleForm",attrs:{model:e.model,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"服务名称",prop:"servicename"}},[a("el-autocomplete",{attrs:{"popper-class":"my-autocomplete","fetch-suggestions":e.querySearchByServicename,placeholder:"请选择服务名称"},on:{select:e.handleSelectByServicename},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(o.value))])]}}]),model:{value:e.model.servicename,callback:function(t){e.$set(e.model,"servicename",t)},expression:"model.servicename"}})],1),a("el-form-item",{attrs:{label:"服务代号",prop:"instanceid"}},[a("el-autocomplete",{attrs:{"popper-class":"my-autocomplete","fetch-suggestions":e.querySearchByInstanceid,placeholder:"请选择服务代号"},on:{select:e.handleSelectByInstanceid},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(o.value))])]}}]),model:{value:e.model.instanceid,callback:function(t){e.$set(e.model,"instanceid",t)},expression:"model.instanceid"}})],1),a("el-form-item",{attrs:{label:"服务类别",prop:"category"}},[a("el-autocomplete",{attrs:{"popper-class":"my-autocomplete","fetch-suggestions":e.querySearchByCategory,placeholder:"请选择服务类别"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(o.value))])]}}]),model:{value:e.model.category,callback:function(t){e.$set(e.model,"category",t)},expression:"model.category"}})],1),a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("Select",{attrs:{clearable:"",placeholder:"请选择类型"},model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},e._l(e.type_options,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("Select",{attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.model.status,callback:function(t){e.$set(e.model,"status",t)},expression:"model.status"}},e._l(e.status_options,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("el-form-item",{attrs:{label:"能力",prop:"ability"}},[a("Select",{attrs:{clearable:"",placeholder:"请选择能力"},model:{value:e.model.ability,callback:function(t){e.$set(e.model,"ability",t)},expression:"model.ability"}},e._l(e.ability_options,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("el-form-item",{attrs:{label:"值",prop:"value"}},[a("el-autocomplete",{attrs:{"popper-class":"my-autocomplete","fetch-suggestions":e.querySearchByValue,placeholder:"请选择值"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item;return[a("span",{staticClass:"addr"},[e._v(e._s(o.label))])]}}]),model:{value:e.model.value,callback:function(t){e.$set(e.model,"value",t)},expression:"model.value"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("Input",{attrs:{placeholder:"请输入备注"},model:{value:e.model.remark,callback:function(t){e.$set(e.model,"remark",t)},expression:"model.remark"}})],1),a("el-form-item",[a("Poptip",{attrs:{confirm:"",title:e.modalSubmit},on:{"on-ok":e.save}},[a("el-button",{attrs:{type:"primary"}},[e._v("提交")])],1),a("el-button",{staticClass:"reset-btn",on:{click:function(t){e.cancel()}}},[e._v("重置")])],1)],1)],1)],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"10px","margin-bottom":"20px"},attrs:{"tooltip-effect":"dark","empty-text":"暂无数据",data:e.tableData,"row-key":"id",border:"",stripe:"","default-sort":{prop:e.orderName,order:e.direction}},on:{"selection-change":e.selectionChange,"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),e._l(e.tableLabel,function(t,o){return t.show?a("el-table-column",{key:o,attrs:{prop:t.prop,label:t.label,sortable:"custom","show-overflow-tooltip":"","filter-placement":"left"},scopedSlots:e._u([{key:"default",fn:function(t){return["status"!==t.column.property||"正常"!==t.row[t.column.property]&&"历史"!==t.row[t.column.property]&&"废弃"!==t.row[t.column.property]?a("span",[e._v(e._s(t.row[t.column.property]))]):a("span",["正常"==t.row.status?a("i",{staticClass:"el-icon-circle-check",staticStyle:{"font-size":"22px",color:"#981AF2"},attrs:{title:"正常"}}):e._e(),"历史"==t.row.status?a("i",{staticClass:"el-icon-time",staticStyle:{"font-size":"22px",color:"#8A148A"},attrs:{title:"历史"}}):e._e(),"废弃"==t.row.status?a("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"22px",color:"#C830C8"},attrs:{title:"废弃"}}):e._e()])]}}])}):e._e()})],2),a("div",{staticStyle:{"text-align":"right"}},[e.total>e.pageSize?a("Page",{attrs:{total:e.total,current:e.pageNo,"page-size":e.pageSize,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}}):e._e()],1)],1)},n=[],r=(a("ac6a"),a("cadf"),a("551c"),a("097d"),a("66df")),i=a("90de"),l=a("bc3a"),s=a.n(l),c=function(){return r["a"].request({url:"configColumns",method:"get"})},u=function(e,t,a,o,n){var l=n?"/"+(Object(i["a"])(n)?encodeURI(n):n):"",s=Object(i["i"])("configs/{0}/{1}/{2}/{3}{4}",[e,t,a,"descending"===o?"desc":"asc",l]);return r["a"].request({url:s,method:"get"})},d=function(e,t,a,o,n){return s.a.all([c(),u(e,t,a,o,n)])},p=function(e){return r["a"].request({url:"config",data:e,method:"post"})},m=function(e){var t={configIds:e};return r["a"].request({url:"config",data:t,method:"delete"})},f=function(e){var t=Object(i["i"])("findDataDictionaryByKey/{0}",[e]);return r["a"].request({url:t,method:"get"})},h=function(){var e="findGlobalTxServerNames";return r["a"].request({url:e,method:"get"})},v=function(e){var t=Object(i["i"])("findGlobalTxServerInstanceIds/{0}",[e]);return r["a"].request({url:t,method:"get"})},y=function(e,t){var a=Object(i["i"])("findGlobalTxServerCategories/{0}/{1}",[e,t]);return r["a"].request({url:a,method:"get"})},b={data:function(){return{servernames:[],serverinstanceids:[],servercategorys:[],tableLabel:[],tableData:[],pageSize:10,pageNo:1,total:0,input:"",orderName:"updatetime",direction:"descending",modalSubmit:"配置修改需谨慎，请确认!",modalAdd:!1,model:{servicename:"",instanceid:"",category:"",type:"",status:"",ability:"",value:"",remark:"",id:-1},type_options:[],status_options:[],ability_options:[],value_options:[],selection:[],rules:{}}},mounted:function(){this.init(),this.loadAllServicenames(),this.loadAllOptions(),this.loadAllValues()},methods:{selectionChange:function(e){this.selection=e},remove:function(){var e=this;if(0===this.selection.length)return this.$Message.info("请勾选要删除的内容");var t=this.selection.map(function(e){return e.id});m(t.join(",")).then(function(t){t.recordSet?(e.$Message.success("删除操作成功"),e.pageNo=1,e.bindData()):e.$Message.error("删除操作失败")})},querySearchByValue:function(e,t){var a=this.value_options,o=e?a.filter(this.createFilterByValue(e)):a;t(o)},createFilterByValue:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},querySearchByCategory:function(e,t){var a=this.servercategorys,o=e?a.filter(this.createFilterByCategory(e)):a;t(o)},createFilterByCategory:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},querySearchByInstanceid:function(e,t){var a=this.serverinstanceids,o=e?a.filter(this.createFilterByInstanceid(e)):a;t(o)},createFilterByInstanceid:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},querySearchByServicename:function(e,t){var a=this.servernames,o=e?a.filter(this.createFilterByServicename(e)):a;t(o)},createFilterByServicename:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelectByServicename:function(e){var t=this,a=encodeURI(this.model.servicename);v(a).then(function(e){t.serverinstanceids=e.recordSet.map(function(e){return{value:e}})})},handleSelectByInstanceid:function(e){var t=this,a=encodeURI(this.model.servicename),o=encodeURI(this.model.instanceid);y(a,o).then(function(e){t.servercategorys=e.recordSet.map(function(e){return{value:e}})})},loadAllServicenames:function(){var e=this;h().then(function(t){e.servernames=t.recordSet.map(function(e){return{value:e}})})},loadAllValues:function(){var e=this;f("config-center-value").then(function(t){for(var a in t.recordSet){var o=t.recordSet[a],n=a;e.value_options.push({value:o,label:n})}})},loadAllOptions:function(){var e=this;f("config-center-type").then(function(t){for(var a in t.recordSet){var o=t.recordSet[a],n=a;e.type_options.push({value:o,label:n})}}),f("config-center-status").then(function(t){for(var a in t.recordSet){var o=t.recordSet[a],n=a;e.status_options.push({value:o,label:n})}}),f("config-center-ability").then(function(t){for(var a in t.recordSet){var o=t.recordSet[a],n=a;e.ability_options.push({value:o,label:n})}})},save:function(){var e=this;this.$refs["ruleForm"].validate(function(t){t&&p(e.model).then(function(t){t.recordSet?(e.pageNo=1,e.bindData(),e.$refs.multipleTable.clearSelection(),e.$Message.success("保存数据成功"),e.modalAdd=!1):e.$Message.error("保存数据失败")})})},modify:function(){if(this.modalSubmit="配置修改需谨慎，请确认!",0===this.selection.length)return this.$Message.info("请勾选要编辑的内容");if(this.selection.length>1)return this.$Message.info("不能批量编辑内容");this.modalAdd=!0;var e=this.selection[0];e&&(this.model["servicename"]=e["servicename"],this.model["instanceid"]=e["instanceid"],this.model["category"]=e["category"],this.model["type"]=e["type_db"]+"",this.model["status"]=e["status_db"]+"",this.model["ability"]=e["ability_db"]+"",this.model["value"]=e["value"],this.model["remark"]=e["remark"],this.model["id"]=e["id"])},add:function(){this.modalSubmit="配置添加需谨慎，请确认!",this.modalAdd=!0,this.model={servicename:"",instanceid:"",category:"",type:"",status:"",ability:"",value:"",remark:"",id:-1}},cancel:function(){this.$refs["ruleForm"].resetFields()},sortChange:function(e){this.orderName=e.prop,this.direction=e.order,this.bindData()},changePage:function(e){this.pageNo=e,this.bindData()},search:function(){if(!this.input)return this.$Message.info("请输入内容");this.pageNo=1,this.bindData()},bindData:function(){var e=[this.pageNo,this.pageSize,this.orderName,this.direction,this.input];this.getData.apply(this,e)},getData:function(e,t,a,o,n){var r=this;u.apply(void 0,arguments).then(function(e){r.tableData.splice(0,r.pageSize),r.tableData=e.recordSet,r.total=parseInt(e.recordsTotal)})},init:function(){var e=this,t=[this.pageNo,this.pageSize,this.orderName,this.direction,this.input];d.apply(void 0,t).then(function(t){t[0].recordSet.forEach(function(t){if(e.tableLabel.push({prop:t.field,label:t.fieldname,show:"true"===t.display}),e.rules[t.field]=[],t.notnull){var a="varchar"===t.type?"请填写":"请选择";e.rules[t.field].push({required:!0,message:a+t.fieldname,trigger:"blur"})}t.fieldlength>0&&"int"!==t.type&&e.rules[t.field].push({max:t.fieldlength,message:"长度不大于"+t.fieldlength+"个字符",trigger:"blur"})}),t[1].recordSet.forEach(function(a){var o={};e.tableLabel.forEach(function(e){o[e.prop]=a[e.prop]}),e.tableData.push(o),e.total=parseInt(t[1].recordsTotal)})})},freshen:function(){this.input="",this.bindData()}}},g=b,S=(a("02eb"),a("2877")),_=Object(S["a"])(g,o,n,!1,null,null,null);_.options.__file="config_center.vue";t["default"]=_.exports}}]);
//# sourceMappingURL=chunk-5f552be0.ac4a388b.js.map