(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55b7920e"],{"1b52":function(t,a,e){"use strict";var n=e("ecb6"),i=e.n(n);i.a},"62ee":function(t,a,e){},"79c1":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("Row",[e("Col",{attrs:{span:"20"}},[e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.freshen}},[t._v("刷新当前页")]),e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.showSubtransaction}},[t._v("显示子事务")]),e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.hide}},[t._v("隐藏子事务")]),e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.pauseGts}},[t._v("暂停全局事务")]),e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.continueGts}},[t._v("继续全局事务")]),e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.stopGts}},[t._v("终止全局事务")]),e("Poptip",{attrs:{confirm:"",title:"降级全局事务后，所有正在运行(含新业务)都将在无全局事务下运行，请确认？"},on:{"on-ok":t.degradeGts,"on-cancel":t.cancel}},[e("Button",{staticClass:"margin-right10",attrs:{type:"primary"}},[t._v("降级全局事务")])],1),e("Button",{staticClass:"margin-right10",attrs:{type:"primary"},on:{click:t.startGts}},[t._v("启用全局事务")])],1),e("Col",{attrs:{span:"4"}},[e("Input",{staticStyle:{width:"200px",float:"right"},attrs:{placeholder:"请输入内容"},model:{value:t.input,callback:function(a){t.input=a},expression:"input"}},[e("Button",{attrs:{slot:"append",icon:"ios-search"},on:{click:function(a){t.search()}},slot:"append"})],1)],1)],1),e("el-table",{ref:"dear",staticStyle:{width:"100%","margin-top":"10px","margin-bottom":"20px"},attrs:{"empty-text":"暂无数据",data:t.tableData,"row-key":"surrogateid",border:"",stripe:"","default-sort":{prop:t.orderName,order:t.direction},"row-class-name":t.rowClassName},on:{"selection-change":t.selectionChange,"sort-change":t.sortChange}},[e("el-table-column",{attrs:{type:"selection",width:"60",align:"center",selectable:t.selectable}}),t._l(t.tableLabel,function(a,n){return e("el-table-column",{key:n,attrs:{prop:a.prop,label:a.label,sortable:-1===t.excludeSortFieldName.indexOf(a.label)&&"custom",width:"状态"!==a.label?0:80,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(a){return["status"!=a.column.property?e("span",[t._v(t._s(a.row[a.column.property]))]):t._e(),"status"==a.column.property?e("span",["运行中"==a.row.status?e("i",{staticClass:"el-icon-video-play",staticStyle:{"font-size":"22px",color:"#00A8E8"},attrs:{title:"运行中"}}):t._e(),"暂停"==a.row.status?e("i",{staticClass:"el-icon-video-pause",staticStyle:{"font-size":"22px",color:"#285096"},attrs:{title:"暂停"}}):t._e(),"运行异常"==a.row.status?e("i",{staticClass:"el-icon-warning-outline",staticStyle:{"font-size":"22px",color:"#146ACE"},attrs:{title:"运行异常"}}):t._e(),"正常结束"==a.row.status?e("i",{staticClass:"el-icon-timer",staticStyle:{"font-size":"22px",color:"#1498EE"},attrs:{title:"正常结束"}}):t._e(),"异常结束"==a.row.status?e("i",{staticClass:"el-icon-help",staticStyle:{"font-size":"22px",color:"#44BCFF"},attrs:{title:"异常结束"}}):t._e()]):t._e()]}}])})})],2),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"right"}},[t.total>t.pageSize?e("Page",{attrs:{total:t.total,current:t.pageNo,"page-size":t.pageSize,"show-total":"","show-elevator":""},on:{"on-change":t.changePage}}):t._e()],1)]),e("div",{staticStyle:{display:"none"}},[e("Modal",{attrs:{title:"Txle"},on:{"on-ok":t.continueAllGts,"on-cancel":t.cancel},model:{value:t.modalContinueGts,callback:function(a){t.modalContinueGts=a},expression:"modalContinueGts"}},[e("p",[t._v("您未选中任何记录，将对所有记录进行操作，请确认？")])]),e("Modal",{attrs:{title:"Txle"},on:{"on-ok":t.pauseAllGts,"on-cancel":t.cancel},model:{value:t.modalPauseGts,callback:function(a){t.modalPauseGts=a},expression:"modalPauseGts"}},[e("p",[t._v("您未选中任何记录，将对所有记录(含新业务)进行暂停操作，请确认？")])]),e("Modal",{attrs:{title:"Txle"},on:{"on-ok":t.showAllSubtransaction,"on-cancel":t.cancel},model:{value:t.modalSubTs,callback:function(a){t.modalSubTs=a},expression:"modalSubTs"}},[e("p",[t._v("您未选中任何记录，将对本页所有全局事务进行操作，请确认？")])])],1)],1)},i=[],o=(e("ac4d"),e("8a81"),e("ac6a"),e("cadf"),e("551c"),e("097d"),e("90de")),s=e("66df"),r=e("bc3a"),l=e.n(r),c=function(){return s["a"].request({url:"transactionColumns",method:"get"})},u=function(t,a,e,n,i){var r=i?"/"+(Object(o["a"])(i)?encodeURI(i):i):"",l=Object(o["i"])("globalTransactions/{0}/{1}/{2}/{3}{4}",[t,a,e,"descending"===n?"desc":"asc",r]);return s["a"].request({url:l,method:"get"})},h=function(t,a,e,n,i){return l.a.all([c(),u(t,a,e,n,i)])},d=function(t){var a={globalTxIds:t};return s["a"].request({url:"subTransactions",data:a,method:"post"})},p=function(t){var a={globalTxIds:t};return s["a"].request({url:"pauseGlobalTransactions",data:a,method:"post"})},f=function(t){var a={globalTxIds:t};return s["a"].request({url:"recoverGlobalTransactions",data:a,method:"post"})},b=function(t){var a={globalTxIds:t};return s["a"].request({url:"terminateGlobalTransactions",data:a,method:"post"})},g=function(){return s["a"].request({url:"pauseAllGlobalTransactions",method:"get"})},m=function(){return s["a"].request({url:"recoverAllGlobalTransactions",method:"get"})},v=function(){return s["a"].request({url:"degradeGlobalTransaction",method:"get"})},y=function(){return s["a"].request({url:"startGlobalTransaction",method:"get"})},x=(e("62ee"),{data:function(){return{tableLabel:[],tableData:[],pageSize:10,pageNo:1,total:0,input:"",orderName:"creationtime",direction:"descending",excludeSortFieldName:["状态","结束时间","全局事务标识"],selection:[],modalContinueGts:!1,modalPauseGts:!1,modalSubTs:!1}},mounted:function(){this.init()},methods:{selectionChange:function(t){this.selection=t},sortChange:function(t){this.orderName=t.prop,this.direction=t.order,this.bindData()},search:function(){if(!this.input)return this.$Message.info("请输入内容");this.pageNo=1,this.bindData()},bindData:function(t){var a=[this.pageNo,this.pageSize,this.orderName,this.direction,this.input,t];this.getData.apply(this,a)},getData:function(t,a,e,n,i,o){var s=this;u.apply(void 0,arguments).then(function(t){s.tableData.splice(0,s.pageSize),t.recordSet.forEach(function(t){var a={hasChildren:!0};s.tableLabel.forEach(function(e){a[e.prop]=t[e.prop]}),s.tableData.push(a)}),s.total=t.recordsTotal,"function"===typeof o&&o()})},changePage:function(t){this.pageNo=t,this.bindData()},init:function(){var t=this,a=[this.pageNo,this.pageSize,this.orderName,this.direction,this.input];h.apply(void 0,a).then(function(a){a[0].recordSet.forEach(function(a){a.display&&t.tableLabel.push({prop:a.field,label:a.fieldname})}),a[1].recordSet.forEach(function(e){var n={hasChildren:!0};t.tableLabel.forEach(function(t){n[t.prop]=e[t.prop]}),t.tableData.push(n),t.total=a[1].recordsTotal})})},showAllSubtransaction:function(){var t=this,a=this.tableData.map(function(t){return t.globaltxid});d(Object(o["b"])(a).join(",")).then(function(a){t.$Message.info("显示子事务成功！"),t.pushSubtransaction(a.recordSet)})},pushSubtransaction:function(t){var a=[];this.tableData.forEach(function(e){a.push(e);var n=t.filter(function(t){return t.globaltxid===e.globaltxid});a=a.concat(n)}),this.tableData=a},showSubtransaction:function(){var t=this;if(this.selection.length>0){var a=[];this.selection.forEach(function(t){a.push(t.globaltxid)}),a.length>0?d(a.join(",")).then(function(a){a.recordSet.length>0?(t.$Message.info("显示子事务成功！"),t.pushSubtransaction(a.recordSet)):t.$Message.info("抱歉，这行事务没有子事务")}):this.$Message.info("显示子事务中止")}else this.modalSubTs=!0},hide:function(){var t=[],a={};if(this.selection.length>0){var e=this.selection.map(function(t){return t.globaltxid}),n=!0,i=!1,o=void 0;try{for(var s,r=this.tableData[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var l=s.value;-1===e.indexOf(l.globaltxid)?t.push(l):a[l.globaltxid]||(t.push(l),a[l.globaltxid]=1)}}catch(b){i=!0,o=b}finally{try{n||null==r.return||r.return()}finally{if(i)throw o}}}else{var c=!0,u=!1,h=void 0;try{for(var d,p=this.tableData[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var f=d.value;a[f.globaltxid]||(t.push(f),a[f.globaltxid]=1)}}catch(b){u=!0,h=b}finally{try{c||null==p.return||p.return()}finally{if(u)throw h}}}this.tableData=t},pauseAllGts:function(){var t=this;g().then(function(a){t.$Message.info("暂停全局事务成功！"),t.bindData()})},pauseGts:function(){var t=this;if(this.selection.length>0){var a=[];this.selection.forEach(function(t){var e=parseInt(t.status_db);0===e&&a.push(t.globaltxid)}),a.length>0?p(a.join(",")).then(function(a){t.$Message.info("暂停全局事务成功！"),t.bindData()}):this.$Message.info("暂停全局事务中止")}else this.modalPauseGts=!0},continueAllGts:function(){var t=this;m().then(function(a){t.$Message.info("继续全局事务成功！"),t.bindData()})},continueGts:function(){var t=this;if(this.selection.length>0){var a=[];this.selection.forEach(function(t){var e=parseInt(t.status_db);2===e&&a.push(t.globaltxid)}),a.length>0?f(a.join(",")).then(function(a){t.$Message.info("继续全局事务成功！"),t.bindData()}):this.$Message.info("继续全局事务中止")}else this.modalContinueGts=!0},stopGts:function(){var t=this;if(this.selection.length>0){var a=[];this.selection.forEach(function(t){var e=parseInt(t.status_db);e<3&&a.push(t.globaltxid)}),a.length>0?b(a.join(",")).then(function(a){t.$Message.info("终止全局事务成功！"),t.bindData()}):this.$Message.info("终止全局事务中止")}else this.$Message.info("您未选中任何记录")},degradeGts:function(){var t=this;v().then(function(a){t.$Message.info("降级全局事务成功！"),t.bindData()})},startGts:function(){var t=this;y().then(function(a){t.$Message.info("启用全局事务成功！"),t.bindData()})},cancel:function(){this.$Message.info("已取消操作")},selectable:function(t,a){return"hasChildren"in t},rowClassName:function(t){return!0===t.row.hasChildren?"info-row":"sub-info-row"},freshen:function(){this.input="",this.bindData()}}}),S=x,w=(e("1b52"),e("2877")),C=Object(w["a"])(S,n,i,!1,null,null,null);C.options.__file="gts.vue";a["default"]=C.exports},ecb6:function(t,a,e){}}]);
//# sourceMappingURL=chunk-55b7920e.aa22dab5.js.map